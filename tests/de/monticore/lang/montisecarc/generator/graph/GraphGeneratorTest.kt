package de.monticore.lang.montisecarc.generator.graph

import com.intellij.testFramework.fixtures.LightCodeInsightFixtureTestCase
import junit.framework.TestCase
import org.junit.Assert.*

/**
 * Copyright 2017 thomasbuning
 *
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 *
 *
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class GraphGeneratorTest: LightCodeInsightFixtureTestCase() {

    override fun getTestDataPath(): String {
        return "testData/Generator"
    }

    fun testGenerator() {

        val configureByFile = myFixture.configureByFiles("CashDeskSystem.secarc", "CashDesk.secarc", "Store.secarc")
        val createGraph = GraphGenerator()
        createGraph.generate(configureByFile.first())
        val inputText = createGraph.generatedInputStream?.bufferedReader()?.use { it.readText() }

        val sb = "CREATE (Generator_CashDeskSystem:Component {name: \"CashDeskSystem\" , type_name:\"Generator.CashDeskSystem\", trustlevel:\"0\", element_offset:\"76\", file_path:\"/src/CashDeskSystem.secarc\", access_roles:\", 'policy'\", configuration:\"test\", cpe:\"cpe:2.3:a:nginx:nginx:1.9.9\", access_control:\"on\"}), (Generator_CashDeskSystem_Image_barcode:Port {name:\"barcode\" , type_name:\"Image\", is_critical:\"false\", element_offset:\"655\", file_path:\"/src/CashDeskSystem.secarc\", access_roles:\", \"}), (Generator_CashDeskSystem_Event_endSale:Port {name:\"endSale\" , type_name:\"Event\", is_critical:\"false\", element_offset:\"709\", file_path:\"/src/CashDeskSystem.secarc\", access_roles:\"'endSale', \"}), (Generator_CashDeskSystem_ProductData_outProductData:Port {name:\"outProductData\" , type_name:\"ProductData\", is_critical:\"false\", element_offset:\"735\", file_path:\"/src/CashDeskSystem.secarc\", access_roles:\", \"}), (Generator_CashDeskSystem_CashDesk_cashDesk:Instance {name: \"cashDesk\" , type_name:\"secarc.seccds.fe.CashDesk\", element_offset:\"772\", file_path:\"/src/CashDeskSystem.secarc\", access_roles:\"\", access_control:\"off\"}), (secarc_seccds_fe_CashDesk_Event_newSale:Port {name:\"newSale\" , type_name:\"Event\", is_critical:\"false\", element_offset:\"178\", file_path:\"/src/CashDesk.secarc\", access_roles:\"\"}), (secarc_seccds_fe_CashDesk_Image_barcode:Port {name:\"barcode\" , type_name:\"Image\", is_critical:\"false\", element_offset:\"204\", file_path:\"/src/CashDesk.secarc\", access_roles:\"\"}), (secarc_seccds_fe_CashDesk_String_outIdentifier:Port {name:\"outIdentifier\" , type_name:\"String\", is_critical:\"false\", element_offset:\"230\", file_path:\"/src/CashDesk.secarc\", access_roles:\"\"}), (secarc_seccds_fe_CashDesk_Event_endSale:Port {name:\"endSale\" , type_name:\"Event\", is_critical:\"false\", element_offset:\"264\", file_path:\"/src/CashDesk.secarc\", access_roles:\"\"}), (secarc_seccds_fe_CashDesk_ProductData_inProductData:Port {name:\"inProductData\" , type_name:\"ProductData\", is_critical:\"false\", element_offset:\"290\", file_path:\"/src/CashDesk.secarc\", access_roles:\"\"}), (secarc_seccds_fe_CashDesk_ProductData_outProductData:Port {name:\"outProductData\" , type_name:\"ProductData\", is_critical:\"false\", element_offset:\"328\", file_path:\"/src/CashDesk.secarc\", access_roles:\"\"}), (secarc_seccds_fe_CashDesk_Event_cardPay:Port {name:\"cardPay\" , type_name:\"Event\", is_critical:\"false\", element_offset:\"370\", file_path:\"/src/CashDesk.secarc\", access_roles:\"\"}), (secarc_seccds_fe_CashDesk_CardData_cardData:Port {name:\"cardData\" , type_name:\"CardData\", is_critical:\"true\", element_offset:\"396\", file_path:\"/src/CashDesk.secarc\", access_roles:\"\"}), (secarc_seccds_fe_CashDesk_Integer_pin:Port {name:\"pin\" , type_name:\"Integer\", is_critical:\"true\", element_offset:\"426\", file_path:\"/src/CashDesk.secarc\", access_roles:\"\"}), (secarc_seccds_fe_CashDesk_BankData_bdOut:Port {name:\"bdOut\" , type_name:\"BankData\", is_critical:\"true\", element_offset:\"459\", file_path:\"/src/CashDesk.secarc\", access_roles:\"\"}), (secarc_seccds_fe_CashDesk_PaymentAck_paIn:Port {name:\"paIn\" , type_name:\"PaymentAck\", is_critical:\"false\", element_offset:\"496\", file_path:\"/src/CashDesk.secarc\", access_roles:\"\"}), (secarc_seccds_fe_CashDesk_Boolean_validation:Port {name:\"validation\" , type_name:\"Boolean\", is_critical:\"false\", element_offset:\"524\", file_path:\"/src/CashDesk.secarc\", access_roles:\"\"}), (secarc_seccds_fe_CashDesk_SaleInformation_saleInformation:Port {name:\"saleInformation\" , type_name:\"SaleInformation\", is_critical:\"false\", element_offset:\"558\", file_path:\"/src/CashDesk.secarc\", access_roles:\"\"}), (Generator_CashDeskSystem_Bank:Component {name: \"Bank\" , type_name:\"Generator.CashDeskSystem.Bank\", trustlevel:\"-1\", element_offset:\"882\", file_path:\"/src/CashDeskSystem.secarc\", access_roles:\"\"}), (Generator_CashDeskSystem_Bank_bank:Instance {name: \"bank\" , type_name:\"Generator.CashDeskSystem.Bank\", element_offset:\"882\", file_path:\"/src/CashDeskSystem.secarc\", access_roles:\"\"}), (Generator_CashDeskSystem_Bank_BankData_bankData:Port {name:\"bankData\" , type_name:\"BankData\", is_critical:\"false\", element_offset:\"942\", file_path:\"/src/CashDeskSystem.secarc\", access_roles:\"\"}), (Generator_CashDeskSystem_Bank_PaymentAck_paymentAck:Port {name:\"paymentAck\" , type_name:\"PaymentAck\", is_critical:\"false\", element_offset:\"977\", file_path:\"/src/CashDeskSystem.secarc\", access_roles:\"\"}), (Generator_CashDeskSystem_Bank_Teller:Component {name: \"Teller\" , type_name:\"Generator.CashDeskSystem.Bank.Teller\", trustlevel:\"0\", element_offset:\"1013\", file_path:\"/src/CashDeskSystem.secarc\", access_roles:\"\"}), (Generator_CashDeskSystem_Bank_Teller_teller:Instance {name: \"teller\" , type_name:\"Generator.CashDeskSystem.Bank.Teller\", element_offset:\"1013\", file_path:\"/src/CashDeskSystem.secarc\", access_roles:\"\"}), (Generator_CashDeskSystem_Bank_Teller_BankData_bTellerIn:Port {name:\"bTellerIn\" , type_name:\"BankData\", is_critical:\"false\", element_offset:\"1057\", file_path:\"/src/CashDeskSystem.secarc\", access_roles:\"\"}), (Generator_CashDeskSystem_Store_store:Instance {name: \"store\" , type_name:\"secarc.seccds.fe.Store\", element_offset:\"1218\", file_path:\"/src/CashDeskSystem.secarc\", access_roles:\"'stockManager', 'storeManager', 'cashier', 'storeManager'\", access_control:\"on\"}), (secarc_seccds_fe_Store_String_inIdentifier:Port {name:\"inIdentifier\" , type_name:\"String\", is_critical:\"false\", element_offset:\"267\", file_path:\"/src/Store.secarc\", access_roles:\"\"}), (secarc_seccds_fe_Store_ProductData_outPData:Port {name:\"outPData\" , type_name:\"ProductData\", is_critical:\"false\", element_offset:\"299\", file_path:\"/src/Store.secarc\", access_roles:\"\"}), (secarc_seccds_fe_Store_SaleInformation_saleInformation:Port {name:\"saleInformation\" , type_name:\"SaleInformation\", is_critical:\"false\", element_offset:\"335\", file_path:\"/src/Store.secarc\", access_roles:\"\"}), (secarc_seccds_fe_CashDesk:Component {name: \"CashDesk\" , type_name:\"secarc.seccds.fe.CashDesk\", trustlevel:\"1\", element_offset:\"103\", file_path:\"/src/CashDesk.secarc\", access_roles:\"\", access_control:\"off\"}), (secarc_seccds_fe_Store_StoreServer:Component {name: \"StoreServer\" , type_name:\"secarc.seccds.fe.Store.StoreServer\", trustlevel:\"0\", element_offset:\"410\", file_path:\"/src/Store.secarc\", access_roles:\"\", configuration:\"confName\", cpe:\"cpeName\"}), (secarc_seccds_fe_Store_StoreServer_storeServer:Instance {name: \"storeServer\" , type_name:\"secarc.seccds.fe.Store.StoreServer\", element_offset:\"410\", file_path:\"/src/Store.secarc\", access_roles:\"\", configuration:\"confName\", cpe:\"cpeName\"}), (secarc_seccds_fe_Store_StoreServer_String_inIdentifier:Port {name:\"inIdentifier\" , type_name:\"String\", is_critical:\"false\", element_offset:\"516\", file_path:\"/src/Store.secarc\", access_roles:\"\"}), (secarc_seccds_fe_Store_StoreServer_SaleInformation_saleInformation:Port {name:\"saleInformation\" , type_name:\"SaleInformation\", is_critical:\"false\", element_offset:\"552\", file_path:\"/src/Store.secarc\", access_roles:\"\"}), (secarc_seccds_fe_Store_StoreServer_ProductData_productData:Port {name:\"productData\" , type_name:\"ProductData\", is_critical:\"false\", element_offset:\"585\", file_path:\"/src/Store.secarc\", access_roles:\"\"}), (secarc_seccds_fe_Store_StoreServer_FilterIdentifier:Component {name: \"FilterIdentifier\" , type_name:\"secarc.seccds.fe.Store.StoreServer.FilterIdentifier\", trustlevel:\"0\", element_offset:\"611\", file_path:\"/src/Store.secarc\", access_roles:\"\"}), (secarc_seccds_fe_Store_StoreServer_FilterIdentifier_filterIdentifier:Instance {name: \"filterIdentifier\" , type_name:\"secarc.seccds.fe.Store.StoreServer.FilterIdentifier\", element_offset:\"611\", file_path:\"/src/Store.secarc\", access_roles:\"\"}), (secarc_seccds_fe_Store_StoreServer_FilterIdentifier_String_inIdentifier:Port {name:\"inIdentifier\" , type_name:\"String\", is_critical:\"false\", element_offset:\"674\", file_path:\"/src/Store.secarc\", access_roles:\"\"}), (secarc_seccds_fe_Store_StoreServer_FilterIdentifier_Identifier_identifier:Port {name:\"identifier\" , type_name:\"Identifier\", is_critical:\"false\", element_offset:\"714\", file_path:\"/src/Store.secarc\", access_roles:\"\"}), (secarc_seccds_fe_Store_StoreServer_DataProcessor:Component {name: \"DataProcessor\" , type_name:\"secarc.seccds.fe.Store.StoreServer.DataProcessor\", trustlevel:\"0\", element_offset:\"749\", file_path:\"/src/Store.secarc\", access_roles:\"\"}), (secarc_seccds_fe_Store_StoreServer_DataProcessor_dataProcessor:Instance {name: \"dataProcessor\" , type_name:\"secarc.seccds.fe.Store.StoreServer.DataProcessor\", element_offset:\"749\", file_path:\"/src/Store.secarc\", access_roles:\"\"}), (secarc_seccds_fe_Store_StoreServer_DataProcessor_ProductData_productData:Port {name:\"productData\" , type_name:\"ProductData\", is_critical:\"false\", element_offset:\"807\", file_path:\"/src/Store.secarc\", access_roles:\"\"}), (secarc_seccds_fe_Store_StoreServer_DataProcessor_Identifier_identifier:Port {name:\"identifier\" , type_name:\"Identifier\", is_critical:\"false\", element_offset:\"840\", file_path:\"/src/Store.secarc\", access_roles:\"\"}), (secarc_seccds_fe_Store_StoreServer_DataProcessor_SaleInformation_filterInfo:Port {name:\"filterInfo\" , type_name:\"SaleInformation\", is_critical:\"false\", element_offset:\"871\", file_path:\"/src/Store.secarc\", access_roles:\"\"}), (tP0:Trustlevel {name:\"+0\", level:0 }), (tM1:Trustlevel {name:\"-1\", level:-1 }), (tP1:Trustlevel {name:\"+1\", level:1 }), (tP2:Trustlevel {name:\"+2\", level:2 }), (Generator_CashDeskSystem_CashDesk_cashDesk)-[:CHILD_OF { dummy: \"\" }]->(Generator_CashDeskSystem), (Generator_CashDeskSystem)-[:PARENT_OF { dummy: \"\" }]->(Generator_CashDeskSystem_CashDesk_cashDesk), (Generator_CashDeskSystem_Store_store)-[:CHILD_OF { dummy: \"\" }]->(Generator_CashDeskSystem), (Generator_CashDeskSystem)-[:PARENT_OF { dummy: \"\" }]->(Generator_CashDeskSystem_Store_store), (Generator_CashDeskSystem)-[:PARENT_OF { dummy: \"\" }]->(Generator_CashDeskSystem_Bank), (Generator_CashDeskSystem_Bank)-[:CHILD_OF { dummy: \"\" }]->(Generator_CashDeskSystem), (tP0)-[:TRUST { dummy: \"\" }]->(Generator_CashDeskSystem), (Generator_CashDeskSystem)-[:TRUST { dummy: \"\" }]->(tP0), (Generator_CashDeskSystem_Store_store)-[:WEAK { dummy: \"\" }]->(Generator_CashDeskSystem_Bank_bank), (Generator_CashDeskSystem_Image_barcode)-[:DECLARES_IN { dummy: \"\" }]->(Generator_CashDeskSystem), (Generator_CashDeskSystem_Event_endSale)-[:DECLARES_IN { dummy: \"\" }]->(Generator_CashDeskSystem), (Generator_CashDeskSystem)-[:DECLARES_OUT { dummy: \"\" }]->(Generator_CashDeskSystem_ProductData_outProductData), (secarc_seccds_fe_CashDesk_Event_newSale)-[:INGOING { dummy: \"\" }]->(Generator_CashDeskSystem_CashDesk_cashDesk), (secarc_seccds_fe_CashDesk_Image_barcode)-[:INGOING { dummy: \"\" }]->(Generator_CashDeskSystem_CashDesk_cashDesk), (Generator_CashDeskSystem_CashDesk_cashDesk)-[:OUTGOING { dummy: \"\" }]->(secarc_seccds_fe_CashDesk_String_outIdentifier), (secarc_seccds_fe_CashDesk_Event_endSale)-[:INGOING { dummy: \"\" }]->(Generator_CashDeskSystem_CashDesk_cashDesk), (secarc_seccds_fe_CashDesk_ProductData_inProductData)-[:INGOING { dummy: \"\" }]->(Generator_CashDeskSystem_CashDesk_cashDesk), (Generator_CashDeskSystem_CashDesk_cashDesk)-[:OUTGOING { dummy: \"\" }]->(secarc_seccds_fe_CashDesk_ProductData_outProductData), (secarc_seccds_fe_CashDesk_Event_cardPay)-[:INGOING { dummy: \"\" }]->(Generator_CashDeskSystem_CashDesk_cashDesk), (secarc_seccds_fe_CashDesk_CardData_cardData)-[:INGOING { dummy: \"\" }]->(Generator_CashDeskSystem_CashDesk_cashDesk), (secarc_seccds_fe_CashDesk_Integer_pin)-[:INGOING { dummy: \"\" }]->(Generator_CashDeskSystem_CashDesk_cashDesk), (Generator_CashDeskSystem_CashDesk_cashDesk)-[:OUTGOING { dummy: \"\" }]->(secarc_seccds_fe_CashDesk_BankData_bdOut), (secarc_seccds_fe_CashDesk_PaymentAck_paIn)-[:INGOING { dummy: \"\" }]->(Generator_CashDeskSystem_CashDesk_cashDesk), (Generator_CashDeskSystem_CashDesk_cashDesk)-[:OUTGOING { dummy: \"\" }]->(secarc_seccds_fe_CashDesk_Boolean_validation), (Generator_CashDeskSystem_CashDesk_cashDesk)-[:OUTGOING { dummy: \"\" }]->(secarc_seccds_fe_CashDesk_SaleInformation_saleInformation), (Generator_CashDeskSystem_CashDesk_cashDesk)-[:INSTANCE_OF { dummy: \"\" }]->(secarc_seccds_fe_CashDesk), (secarc_seccds_fe_CashDesk)-[:DEFINES { dummy: \"\" }]->(Generator_CashDeskSystem_CashDesk_cashDesk), (secarc_seccds_fe_CashDesk_Event_newSale)-[:DECLARES_IN { dummy: \"\" }]->(Generator_CashDeskSystem_CashDesk_cashDesk), (secarc_seccds_fe_CashDesk_Image_barcode)-[:DECLARES_IN { dummy: \"\" }]->(Generator_CashDeskSystem_CashDesk_cashDesk), (Generator_CashDeskSystem_CashDesk_cashDesk)-[:DECLARES_OUT { dummy: \"\" }]->(secarc_seccds_fe_CashDesk_String_outIdentifier), (secarc_seccds_fe_CashDesk_Event_endSale)-[:DECLARES_IN { dummy: \"\" }]->(Generator_CashDeskSystem_CashDesk_cashDesk), (secarc_seccds_fe_CashDesk_ProductData_inProductData)-[:DECLARES_IN { dummy: \"\" }]->(Generator_CashDeskSystem_CashDesk_cashDesk), (Generator_CashDeskSystem_CashDesk_cashDesk)-[:DECLARES_OUT { dummy: \"\" }]->(secarc_seccds_fe_CashDesk_ProductData_outProductData), (secarc_seccds_fe_CashDesk_Event_cardPay)-[:DECLARES_IN { dummy: \"\" }]->(Generator_CashDeskSystem_CashDesk_cashDesk), (secarc_seccds_fe_CashDesk_CardData_cardData)-[:DECLARES_IN { dummy: \"\" }]->(Generator_CashDeskSystem_CashDesk_cashDesk), (secarc_seccds_fe_CashDesk_Integer_pin)-[:DECLARES_IN { dummy: \"\" }]->(Generator_CashDeskSystem_CashDesk_cashDesk), (Generator_CashDeskSystem_CashDesk_cashDesk)-[:DECLARES_OUT { dummy: \"\" }]->(secarc_seccds_fe_CashDesk_BankData_bdOut), (secarc_seccds_fe_CashDesk_PaymentAck_paIn)-[:DECLARES_IN { dummy: \"\" }]->(Generator_CashDeskSystem_CashDesk_cashDesk), (Generator_CashDeskSystem_CashDesk_cashDesk)-[:DECLARES_OUT { dummy: \"\" }]->(secarc_seccds_fe_CashDesk_Boolean_validation), (Generator_CashDeskSystem_CashDesk_cashDesk)-[:DECLARES_OUT { dummy: \"\" }]->(secarc_seccds_fe_CashDesk_SaleInformation_saleInformation), (secarc_seccds_fe_CashDesk_BankData_bdOut)-[:ENCRYPTED { dummy: \"\" , element_offset:\"790\", file_path:\"/src/CashDeskSystem.secarc\"}]->(Generator_CashDeskSystem_Bank_BankData_bankData), (secarc_seccds_fe_CashDesk_SaleInformation_saleInformation)-[:ENCRYPTED { dummy: \"\" , element_offset:\"824\", file_path:\"/src/CashDeskSystem.secarc\"}]->(secarc_seccds_fe_Store_SaleInformation_saleInformation), (Generator_CashDeskSystem_Bank_bank)-[:INSTANCE_OF { dummy: \"\" }]->(Generator_CashDeskSystem_Bank), (Generator_CashDeskSystem_Bank)-[:DEFINES { dummy: \"\" }]->(Generator_CashDeskSystem_Bank_bank), (Generator_CashDeskSystem_Bank_BankData_bankData)-[:INGOING { dummy: \"\" }]->(Generator_CashDeskSystem_Bank_bank), (Generator_CashDeskSystem_Bank_bank)-[:OUTGOING { dummy: \"\" }]->(Generator_CashDeskSystem_Bank_PaymentAck_paymentAck), (Generator_CashDeskSystem_Bank)-[:PARENT_OF { dummy: \"\" }]->(Generator_CashDeskSystem_Bank_Teller), (Generator_CashDeskSystem_Bank_Teller)-[:CHILD_OF { dummy: \"\" }]->(Generator_CashDeskSystem_Bank), (tM1)-[:TRUST { dummy: \"\" }]->(Generator_CashDeskSystem_Bank), (Generator_CashDeskSystem_Bank)-[:TRUST { dummy: \"\" }]->(tM1), (Generator_CashDeskSystem_Bank_BankData_bankData)-[:DECLARES_IN { dummy: \"\" }]->(Generator_CashDeskSystem_Bank), (Generator_CashDeskSystem_Bank)-[:DECLARES_OUT { dummy: \"\" }]->(Generator_CashDeskSystem_Bank_PaymentAck_paymentAck), (Generator_CashDeskSystem_Bank_Teller_teller)-[:INSTANCE_OF { dummy: \"\" }]->(Generator_CashDeskSystem_Bank_Teller), (Generator_CashDeskSystem_Bank_Teller)-[:DEFINES { dummy: \"\" }]->(Generator_CashDeskSystem_Bank_Teller_teller), (Generator_CashDeskSystem_Bank_Teller_BankData_bTellerIn)-[:INGOING { dummy: \"\" }]->(Generator_CashDeskSystem_Bank_Teller_teller), (tM1)-[:TRUST { dummy: \"\" }]->(Generator_CashDeskSystem_Bank_Teller), (Generator_CashDeskSystem_Bank_Teller)-[:TRUST { dummy: \"\" }]->(tM1), (Generator_CashDeskSystem_Bank_Teller_BankData_bTellerIn)-[:DECLARES_IN { dummy: \"\" }]->(Generator_CashDeskSystem_Bank_Teller), (secarc_seccds_fe_Store_ProductData_outPData)-[:UNENCRYPTED { dummy: \"\" , element_offset:\"1164\", file_path:\"/src/CashDeskSystem.secarc\"}]->(Generator_CashDeskSystem_Bank_Teller_BankData_bTellerIn), (secarc_seccds_fe_Store_String_inIdentifier)-[:INGOING { dummy: \"\" }]->(Generator_CashDeskSystem_Store_store), (Generator_CashDeskSystem_Store_store)-[:OUTGOING { dummy: \"\" }]->(secarc_seccds_fe_Store_ProductData_outPData), (secarc_seccds_fe_Store_SaleInformation_saleInformation)-[:INGOING { dummy: \"\" }]->(Generator_CashDeskSystem_Store_store), (Generator_CashDeskSystem_Store_store)-[:INSTANCE_OF { dummy: \"\" }]->(Generator_CashDeskSystem), (Generator_CashDeskSystem)-[:DEFINES { dummy: \"\" }]->(Generator_CashDeskSystem_Store_store), (secarc_seccds_fe_Store_String_inIdentifier)-[:DECLARES_IN { dummy: \"\" }]->(Generator_CashDeskSystem_Store_store), (Generator_CashDeskSystem_Store_store)-[:DECLARES_OUT { dummy: \"\" }]->(secarc_seccds_fe_Store_ProductData_outPData), (secarc_seccds_fe_Store_SaleInformation_saleInformation)-[:DECLARES_IN { dummy: \"\" }]->(Generator_CashDeskSystem_Store_store), (Generator_CashDeskSystem_Bank_PaymentAck_paymentAck)-[:UNENCRYPTED { dummy: \"\" , element_offset:\"1281\", file_path:\"/src/CashDeskSystem.secarc\"}]->(secarc_seccds_fe_CashDesk_PaymentAck_paIn), (secarc_seccds_fe_Store_ProductData_outPData)-[:ENCRYPTED { dummy: \"\" , element_offset:\"1340\", file_path:\"/src/CashDeskSystem.secarc\"}]->(secarc_seccds_fe_CashDesk_ProductData_inProductData), (Generator_CashDeskSystem_CashDesk_cashDesk)-[:STRONG { dummy: \"\" }]->(Generator_CashDeskSystem_Store_store), (Generator_CashDeskSystem_Bank_bank)-[:WEAK { dummy: \"\" }]->(Generator_CashDeskSystem_Store_store), (secarc_seccds_fe_CashDesk_Event_newSale)-[:DECLARES_IN { dummy: \"\" }]->(secarc_seccds_fe_CashDesk), (secarc_seccds_fe_CashDesk_Image_barcode)-[:DECLARES_IN { dummy: \"\" }]->(secarc_seccds_fe_CashDesk), (secarc_seccds_fe_CashDesk)-[:DECLARES_OUT { dummy: \"\" }]->(secarc_seccds_fe_CashDesk_String_outIdentifier), (secarc_seccds_fe_CashDesk_Event_endSale)-[:DECLARES_IN { dummy: \"\" }]->(secarc_seccds_fe_CashDesk), (secarc_seccds_fe_CashDesk_ProductData_inProductData)-[:DECLARES_IN { dummy: \"\" }]->(secarc_seccds_fe_CashDesk), (secarc_seccds_fe_CashDesk)-[:DECLARES_OUT { dummy: \"\" }]->(secarc_seccds_fe_CashDesk_ProductData_outProductData), (secarc_seccds_fe_CashDesk_Event_cardPay)-[:DECLARES_IN { dummy: \"\" }]->(secarc_seccds_fe_CashDesk), (secarc_seccds_fe_CashDesk_CardData_cardData)-[:DECLARES_IN { dummy: \"\" }]->(secarc_seccds_fe_CashDesk), (secarc_seccds_fe_CashDesk_Integer_pin)-[:DECLARES_IN { dummy: \"\" }]->(secarc_seccds_fe_CashDesk), (secarc_seccds_fe_CashDesk)-[:DECLARES_OUT { dummy: \"\" }]->(secarc_seccds_fe_CashDesk_BankData_bdOut), (secarc_seccds_fe_CashDesk_PaymentAck_paIn)-[:DECLARES_IN { dummy: \"\" }]->(secarc_seccds_fe_CashDesk), (secarc_seccds_fe_CashDesk)-[:DECLARES_OUT { dummy: \"\" }]->(secarc_seccds_fe_CashDesk_Boolean_validation), (secarc_seccds_fe_CashDesk)-[:DECLARES_OUT { dummy: \"\" }]->(secarc_seccds_fe_CashDesk_SaleInformation_saleInformation), (tP1)-[:TRUST { dummy: \"\" }]->(secarc_seccds_fe_CashDesk), (secarc_seccds_fe_CashDesk)-[:TRUST { dummy: \"\" }]->(tP1), (secarc_seccds_fe_Store_String_inIdentifier)-[:DECLARES_IN { dummy: \"\" }]->(Generator_CashDeskSystem), (Generator_CashDeskSystem)-[:DECLARES_OUT { dummy: \"\" }]->(secarc_seccds_fe_Store_ProductData_outPData), (secarc_seccds_fe_Store_SaleInformation_saleInformation)-[:DECLARES_IN { dummy: \"\" }]->(Generator_CashDeskSystem), (secarc_seccds_fe_Store_StoreServer_storeServer)-[:INSTANCE_OF { dummy: \"\" }]->(secarc_seccds_fe_Store_StoreServer), (secarc_seccds_fe_Store_StoreServer)-[:DEFINES { dummy: \"\" }]->(secarc_seccds_fe_Store_StoreServer_storeServer), (secarc_seccds_fe_Store_StoreServer_String_inIdentifier)-[:INGOING { dummy: \"\" }]->(secarc_seccds_fe_Store_StoreServer_storeServer), (secarc_seccds_fe_Store_StoreServer_storeServer)-[:OUTGOING { dummy: \"\" }]->(secarc_seccds_fe_Store_StoreServer_SaleInformation_saleInformation), (secarc_seccds_fe_Store_StoreServer_storeServer)-[:OUTGOING { dummy: \"\" }]->(secarc_seccds_fe_Store_StoreServer_ProductData_productData), (secarc_seccds_fe_Store_StoreServer)-[:PARENT_OF { dummy: \"\" }]->(secarc_seccds_fe_Store_StoreServer_FilterIdentifier), (secarc_seccds_fe_Store_StoreServer_FilterIdentifier)-[:CHILD_OF { dummy: \"\" }]->(secarc_seccds_fe_Store_StoreServer), (secarc_seccds_fe_Store_StoreServer)-[:PARENT_OF { dummy: \"\" }]->(secarc_seccds_fe_Store_StoreServer_DataProcessor), (secarc_seccds_fe_Store_StoreServer_DataProcessor)-[:CHILD_OF { dummy: \"\" }]->(secarc_seccds_fe_Store_StoreServer), (tP2)-[:TRUST { dummy: \"\" }]->(secarc_seccds_fe_Store_StoreServer), (secarc_seccds_fe_Store_StoreServer)-[:TRUST { dummy: \"\" }]->(tP2), (secarc_seccds_fe_Store_StoreServer_String_inIdentifier)-[:DECLARES_IN { dummy: \"\" }]->(secarc_seccds_fe_Store_StoreServer), (secarc_seccds_fe_Store_StoreServer)-[:DECLARES_OUT { dummy: \"\" }]->(secarc_seccds_fe_Store_StoreServer_SaleInformation_saleInformation), (secarc_seccds_fe_Store_StoreServer)-[:DECLARES_OUT { dummy: \"\" }]->(secarc_seccds_fe_Store_StoreServer_ProductData_productData), (secarc_seccds_fe_Store_StoreServer_FilterIdentifier_filterIdentifier)-[:INSTANCE_OF { dummy: \"\" }]->(secarc_seccds_fe_Store_StoreServer_FilterIdentifier), (secarc_seccds_fe_Store_StoreServer_FilterIdentifier)-[:DEFINES { dummy: \"\" }]->(secarc_seccds_fe_Store_StoreServer_FilterIdentifier_filterIdentifier), (secarc_seccds_fe_Store_StoreServer_FilterIdentifier_String_inIdentifier)-[:INGOING { dummy: \"\" }]->(secarc_seccds_fe_Store_StoreServer_FilterIdentifier_filterIdentifier), (secarc_seccds_fe_Store_StoreServer_FilterIdentifier_filterIdentifier)-[:OUTGOING { dummy: \"\" }]->(secarc_seccds_fe_Store_StoreServer_FilterIdentifier_Identifier_identifier), (tP2)-[:TRUST { dummy: \"\" }]->(secarc_seccds_fe_Store_StoreServer_FilterIdentifier), (secarc_seccds_fe_Store_StoreServer_FilterIdentifier)-[:TRUST { dummy: \"\" }]->(tP2), (secarc_seccds_fe_Store_StoreServer_FilterIdentifier_String_inIdentifier)-[:DECLARES_IN { dummy: \"\" }]->(secarc_seccds_fe_Store_StoreServer_FilterIdentifier), (secarc_seccds_fe_Store_StoreServer_FilterIdentifier)-[:DECLARES_OUT { dummy: \"\" }]->(secarc_seccds_fe_Store_StoreServer_FilterIdentifier_Identifier_identifier), (secarc_seccds_fe_Store_StoreServer_DataProcessor_dataProcessor)-[:INSTANCE_OF { dummy: \"\" }]->(secarc_seccds_fe_Store_StoreServer_DataProcessor), (secarc_seccds_fe_Store_StoreServer_DataProcessor)-[:DEFINES { dummy: \"\" }]->(secarc_seccds_fe_Store_StoreServer_DataProcessor_dataProcessor), (secarc_seccds_fe_Store_StoreServer_DataProcessor_dataProcessor)-[:OUTGOING { dummy: \"\" }]->(secarc_seccds_fe_Store_StoreServer_DataProcessor_ProductData_productData), (secarc_seccds_fe_Store_StoreServer_DataProcessor_Identifier_identifier)-[:INGOING { dummy: \"\" }]->(secarc_seccds_fe_Store_StoreServer_DataProcessor_dataProcessor), (secarc_seccds_fe_Store_StoreServer_DataProcessor_SaleInformation_filterInfo)-[:INGOING { dummy: \"\" }]->(secarc_seccds_fe_Store_StoreServer_DataProcessor_dataProcessor), (tP2)-[:TRUST { dummy: \"\" }]->(secarc_seccds_fe_Store_StoreServer_DataProcessor), (secarc_seccds_fe_Store_StoreServer_DataProcessor)-[:TRUST { dummy: \"\" }]->(tP2), (secarc_seccds_fe_Store_StoreServer_DataProcessor)-[:DECLARES_OUT { dummy: \"\" }]->(secarc_seccds_fe_Store_StoreServer_DataProcessor_ProductData_productData), (secarc_seccds_fe_Store_StoreServer_DataProcessor_Identifier_identifier)-[:DECLARES_IN { dummy: \"\" }]->(secarc_seccds_fe_Store_StoreServer_DataProcessor), (secarc_seccds_fe_Store_StoreServer_DataProcessor_SaleInformation_filterInfo)-[:DECLARES_IN { dummy: \"\" }]->(secarc_seccds_fe_Store_StoreServer_DataProcessor), (secarc_seccds_fe_Store_StoreServer_SaleInformation_saleInformation)-[:UNENCRYPTED { dummy: \"\" , element_offset:\"930\", file_path:\"/src/Store.secarc\"}]->(secarc_seccds_fe_Store_StoreServer_DataProcessor_SaleInformation_filterInfo), (Generator_CashDeskSystem)-[:PARENT_OF { dummy: \"\" }]->(secarc_seccds_fe_Store_StoreServer), (secarc_seccds_fe_Store_StoreServer)-[:CHILD_OF { dummy: \"\" }]->(Generator_CashDeskSystem), (tP2)-[:TRUST { dummy: \"\" }]->(Generator_CashDeskSystem), (Generator_CashDeskSystem)-[:TRUST { dummy: \"\" }]->(tP2);"

        TestCase.assertEquals(inputText, sb)
    }

    fun testClearanceForGenerator() {

        val configureByFiles = myFixture.configureByFiles("ClearanceFor.secarc", "MSASecurityClass.java", "SecretData.java", "SecurityClassification.java")
        val createGraph = GraphGenerator()
        createGraph.generate(configureByFiles.first())
        val inputText = createGraph.generatedInputStream?.bufferedReader()?.use { it.readText() }

        val sb = "CREATE (Generator_Environment:Component {name: \"Environment\" , type_name:\"Generator.Environment\", trustlevel:\"-1\", element_offset:\"165\", file_path:\"/src/ClearanceFor.secarc\", access_roles:\"\", access_control:\"off\"}), (Generator_Environment_DummyA:Component {name: \"DummyA\" , type_name:\"Generator.Environment.DummyA\", trustlevel:\"0\", element_offset:\"218\", file_path:\"/src/ClearanceFor.secarc\", access_roles:\"\"}), (Generator_Environment_DummyA_dummyA:Instance {name: \"dummyA\" , type_name:\"Generator.Environment.DummyA\", element_offset:\"218\", file_path:\"/src/ClearanceFor.secarc\", access_roles:\"\"}), (Generator_Environment_DummyA_SecretData_outSecret:Port {name:\"outSecret\" , type_name:\"SecretData\", is_critical:\"false\", element_offset:\"297\", file_path:\"/src/ClearanceFor.secarc\", access_roles:\"\"}), (Generator_Environment_DummyB:Component {name: \"DummyB\" , type_name:\"Generator.Environment.DummyB\", trustlevel:\"0\", element_offset:\"334\", file_path:\"/src/ClearanceFor.secarc\", access_roles:\"\"}), (Generator_Environment_DummyB_dummyB:Instance {name: \"dummyB\" , type_name:\"Generator.Environment.DummyB\", element_offset:\"334\", file_path:\"/src/ClearanceFor.secarc\", access_roles:\"\"}), (Generator_Environment_DummyB_SecretData_inSecret:Port {name:\"inSecret\" , type_name:\"SecretData\", is_critical:\"false\", element_offset:\"413\", file_path:\"/src/ClearanceFor.secarc\", access_roles:\"\"}), (tM1:Trustlevel {name:\"-1\", level:-1 }), (NON_CONFIDENTIAL:SecurityClass {name:\"NON_CONFIDENTIAL\" , element_offset:\"0\", file_path:\"/src/ClearanceFor.secarc\"}), (CONFIDENTIAL:SecurityClass {name:\"CONFIDENTIAL\" , element_offset:\"0\", file_path:\"/src/ClearanceFor.secarc\"}), (SECRET:SecurityClass {name:\"SECRET\" , element_offset:\"0\", file_path:\"/src/ClearanceFor.secarc\"}), (TOP_SECRET:SecurityClass {name:\"TOP_SECRET\" , element_offset:\"0\", file_path:\"/src/ClearanceFor.secarc\"}), (Generator_Environment)-[:PARENT_OF { dummy: \"\" }]->(Generator_Environment_DummyA), (Generator_Environment_DummyA)-[:CHILD_OF { dummy: \"\" }]->(Generator_Environment), (Generator_Environment)-[:PARENT_OF { dummy: \"\" }]->(Generator_Environment_DummyB), (Generator_Environment_DummyB)-[:CHILD_OF { dummy: \"\" }]->(Generator_Environment), (tM1)-[:TRUST { dummy: \"\" }]->(Generator_Environment), (Generator_Environment)-[:TRUST { dummy: \"\" }]->(tM1), (Generator_Environment_DummyA_dummyA)-[:INSTANCE_OF { dummy: \"\" }]->(Generator_Environment_DummyA), (Generator_Environment_DummyA)-[:DEFINES { dummy: \"\" }]->(Generator_Environment_DummyA_dummyA), (Generator_Environment_DummyA_dummyA)-[:OUTGOING { dummy: \"\" }]->(Generator_Environment_DummyA_SecretData_outSecret), (tM1)-[:TRUST { dummy: \"\" }]->(Generator_Environment_DummyA), (Generator_Environment_DummyA)-[:TRUST { dummy: \"\" }]->(tM1), (Generator_Environment_DummyA)-[:DECLARES_OUT { dummy: \"\" }]->(Generator_Environment_DummyA_SecretData_outSecret), (Generator_Environment_DummyA_SecretData_outSecret)-[:SECURITY_CLASS { dummy: \"\" }]->(SECRET), (Generator_Environment_DummyB_dummyB)-[:INSTANCE_OF { dummy: \"\" }]->(Generator_Environment_DummyB), (Generator_Environment_DummyB)-[:DEFINES { dummy: \"\" }]->(Generator_Environment_DummyB_dummyB), (Generator_Environment_DummyB_SecretData_inSecret)-[:INGOING { dummy: \"\" }]->(Generator_Environment_DummyB_dummyB), (tM1)-[:TRUST { dummy: \"\" }]->(Generator_Environment_DummyB), (Generator_Environment_DummyB)-[:TRUST { dummy: \"\" }]->(tM1), (Generator_Environment_DummyB_SecretData_inSecret)-[:DECLARES_IN { dummy: \"\" }]->(Generator_Environment_DummyB), (Generator_Environment_DummyB_SecretData_inSecret)-[:SECURITY_CLASS { dummy: \"\" }]->(SECRET), (Generator_Environment_DummyA_SecretData_outSecret)-[:ENCRYPTED { dummy: \"\" , element_offset:\"456\", file_path:\"/src/ClearanceFor.secarc\"}]->(Generator_Environment_DummyB_SecretData_inSecret), (Generator_Environment_DummyA)-[:CLEARANCE_FOR { dummy: \"\" }]->(NON_CONFIDENTIAL), (Generator_Environment_DummyB)-[:CLEARANCE_FOR { dummy: \"\" }]->(NON_CONFIDENTIAL), (NON_CONFIDENTIAL)-[:WEAKER { dummy: \"\" }]->(CONFIDENTIAL), (CONFIDENTIAL)-[:WEAKER { dummy: \"\" }]->(SECRET), (SECRET)-[:WEAKER { dummy: \"\" }]->(TOP_SECRET);"

        TestCase.assertEquals(inputText, sb)
    }
}